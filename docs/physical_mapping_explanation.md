# ç‰©ç†ä½ç½®ä¼˜åŒ–ï¼šè¿æ¥æ€§é©±åŠ¨çš„åˆ†åŒºæ˜ å°„

## ğŸ¯ æ ¸å¿ƒæ€æƒ³

**ç›®æ ‡**ï¼šæœ€å°åŒ–è·¨åˆ†åŒºè¿çº¿çš„æ€»é•¿åº¦ï¼ˆHPWLï¼‰

**ç­–ç•¥**ï¼šå°†é€»è¾‘è¿æ¥å¼ºçš„åˆ†åŒºç‰©ç†ä¸Šæ”¾ç½®åœ¨ç›¸é‚»ä½ç½®

---

## ğŸ“Š è¿æ¥æ€§çŸ©é˜µ

### æ„å»ºè¿‡ç¨‹

```python
connectivity_matrix[i][j] = åˆ†åŒºiå’Œåˆ†åŒºjä¹‹é—´çš„è¾¹ç•Œnetæ•°é‡
```

**ç¤ºä¾‹**ï¼šå‡è®¾æœ‰4ä¸ªåˆ†åŒº(P0, P1, P2, P3)

```
åˆ†åŒºé—´çš„netè¿æ¥ï¼š
- net1: P0 â†” P1  (1æ¡)
- net2: P0 â†” P2  (1æ¡)
- net3: P1 â†” P2  (1æ¡)
- net4: P1 â†” P3  (1æ¡)
```

**è¿æ¥æ€§çŸ©é˜µ**ï¼š
```
     P0  P1  P2  P3
P0 [  0   1   1   0 ]
P1 [  1   0   1   1 ]
P2 [  1   1   0   0 ]
P3 [  0   1   0   0 ]
```

**è§£è¯»**ï¼š
- `connectivity_matrix[0][1] = 1`ï¼šP0å’ŒP1ä¹‹é—´æœ‰1æ¡è¾¹ç•Œnet
- `connectivity_matrix[1][2] = 1`ï¼šP1å’ŒP2ä¹‹é—´æœ‰1æ¡è¾¹ç•Œnet
- P1æ˜¯"æœ€çƒ­"çš„åˆ†åŒºï¼ˆä¸3ä¸ªå…¶ä»–åˆ†åŒºéƒ½æœ‰è¿æ¥ï¼‰

---

## ğŸ§® è´ªå¿ƒä¼˜åŒ–ç®—æ³•è¯¦è§£

### ç¬¬1æ­¥ï¼šæ‰¾åˆ°è¿æ¥æœ€å¼ºçš„åˆ†åŒºå¯¹

```python
# éå†è¿æ¥æ€§çŸ©é˜µï¼Œæ‰¾æœ€å¤§å€¼
max_connection = max(connectivity_matrix[i][j] for all i, j where i != j)
```

**ç¤ºä¾‹**ï¼š
- å‡è®¾P1-P2çš„è¿æ¥æœ€å¼ºï¼ˆæœ‰å¤šæ¡netï¼‰
- å°†å®ƒä»¬ä½œä¸ºèµ·å§‹åˆ†åŒºå¯¹

### ç¬¬2æ­¥ï¼šç›¸é‚»æ”¾ç½®èµ·å§‹åˆ†åŒºå¯¹

**ç‰©ç†ç½‘æ ¼**ï¼ˆ2x2ï¼‰ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Grid0  â”‚  Grid1  â”‚  â† ä¸Šå±‚
â”‚ (å·¦ä¸‹)  â”‚ (å³ä¸‹)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Grid2  â”‚  Grid3  â”‚  â† ä¸‹å±‚
â”‚ (å·¦ä¸Š)  â”‚ (å³ä¸Š)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç›¸é‚»å…³ç³»**ï¼š
- Grid0ç›¸é‚»ï¼šGrid1(å³), Grid2(ä¸Š)
- Grid1ç›¸é‚»ï¼šGrid0(å·¦), Grid3(ä¸Š)
- Grid2ç›¸é‚»ï¼šGrid0(ä¸‹), Grid3(å³)
- Grid3ç›¸é‚»ï¼šGrid2(å·¦), Grid1(ä¸‹)

**æ”¾ç½®èµ·å§‹å¯¹**ï¼š
```
å°†P1æ”¾åœ¨Grid0ï¼ˆå·¦ä¸‹ï¼‰
å°†P2æ”¾åœ¨Grid1ï¼ˆå³ä¸‹ï¼‰ â† ä¸Grid0ç›¸é‚»
```

### ç¬¬3æ­¥ï¼šè¿­ä»£æ”¾ç½®å‰©ä½™åˆ†åŒº

å¯¹äºæ¯ä¸ªæœªæ”¾ç½®çš„åˆ†åŒºï¼Œè®¡ç®—å…¶ä¸**å·²æ”¾ç½®åˆ†åŒº**çš„è¿æ¥å¼ºåº¦ï¼š

```python
for æ¯ä¸ªæœªæ”¾ç½®åˆ†åŒº pid:
    score = sum(connectivity_matrix[pid][placed_pid] 
                for placed_pid in å·²æ”¾ç½®åˆ†åŒº)
    
    # é€‰æ‹©scoreæœ€å¤§çš„åˆ†åŒº
```

**ç¤ºä¾‹**ï¼š
- å·²æ”¾ç½®ï¼šP1(Grid0), P2(Grid1)
- å¾…æ”¾ç½®ï¼šP0, P3

è®¡ç®—è¿æ¥å¼ºåº¦ï¼š
```
P0çš„score = conn[P0][P1] + conn[P0][P2] = 1 + 1 = 2
P3çš„score = conn[P3][P1] + conn[P3][P2] = 1 + 0 = 1
```

â†’ é€‰æ‹©P0ï¼ˆè¿æ¥æ›´å¼ºï¼‰

### ç¬¬4æ­¥ï¼šä¸ºé€‰ä¸­åˆ†åŒºæ‰¾æœ€ä½³ç‰©ç†ä½ç½®

å¯¹äºP0ï¼Œæ£€æŸ¥æ‰€æœ‰ç©ºé—²gridä½ç½®ï¼Œè®¡ç®—å…¶ä¸**å·²å ç”¨ç›¸é‚»grid**çš„è¿æ¥å¼ºåº¦ï¼š

```python
for æ¯ä¸ªç©ºé—²grid_id:
    adjacent_grids = get_adjacent_grids(grid_id)
    
    grid_score = 0
    for adj_grid in adjacent_grids:
        if adj_gridå·²è¢«å ç”¨:
            adj_partition = grid_to_partition[adj_grid]
            grid_score += connectivity_matrix[P0][adj_partition]
    
    # é€‰æ‹©grid_scoreæœ€å¤§çš„ä½ç½®
```

**ç¤ºä¾‹**ï¼šP0çš„å€™é€‰ä½ç½®

**å€™é€‰1ï¼šGrid2ï¼ˆå·¦ä¸Šï¼‰**
- ç›¸é‚»ï¼šGrid0(P1), Grid3(ç©º)
- Score = conn[P0][P1] = 1

**å€™é€‰2ï¼šGrid3ï¼ˆå³ä¸Šï¼‰**
- ç›¸é‚»ï¼šGrid1(P2), Grid2(ç©º)
- Score = conn[P0][P2] = 1

â†’ ä¸¤è€…scoreç›¸åŒï¼Œé€‰Grid2ï¼ˆæ›´é è¿‘å¤šä¸ªå·²å ç”¨ä½ç½®ï¼‰

### ç¬¬5æ­¥ï¼šé‡å¤ç›´åˆ°æ‰€æœ‰åˆ†åŒºæ”¾ç½®å®Œæˆ

```
æœ€ç»ˆå¸ƒå±€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   P0    â”‚   P3    â”‚
â”‚ Grid2   â”‚ Grid3   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1    â”‚   P2    â”‚
â”‚ Grid0   â”‚ Grid1   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ ä¼˜åŒ–æ•ˆæœ

### ä¼˜åŒ–å‰ï¼ˆç®€å•ç½‘æ ¼å¸ƒå±€ï¼‰

```
æŒ‰åˆ†åŒºIDé¡ºåºæ’åˆ—ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   P0    â”‚   P1    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P2    â”‚   P3    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è·¨åˆ†åŒºè¿çº¿ï¼š
- P0-P1: ç›¸é‚» âœ“ (æ°´å¹³ç›¸é‚»)
- P0-P2: ç›¸é‚» âœ“ (å‚ç›´ç›¸é‚»)
- P1-P2: å¯¹è§’ âœ— (ä¸ç›¸é‚»ï¼Œè·ç¦»è¿œ)
- P1-P3: ç›¸é‚» âœ“ (å‚ç›´ç›¸é‚»)
```

**è¾¹ç•ŒHPWLä¼°ç®—**ï¼š
```
HPWL â‰ˆ 1Ã—w + 1Ã—h + 1Ã—âˆš(wÂ²+hÂ²) + 1Ã—h
     = w + 2h + âˆš(wÂ²+hÂ²)
```
å…¶ä¸­ï¼Œâˆš(wÂ²+hÂ²) æ˜¯å¯¹è§’çº¿è·ç¦»ï¼ˆè¾ƒé•¿ï¼‰

### ä¼˜åŒ–åï¼ˆè´ªå¿ƒå¸ƒå±€ï¼‰

```
åŸºäºè¿æ¥æ€§ä¼˜åŒ–ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   P0    â”‚   P3    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1    â”‚   P2    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è·¨åˆ†åŒºè¿çº¿ï¼š
- P0-P1: ç›¸é‚» âœ“ (å‚ç›´ç›¸é‚»)
- P0-P2: å¯¹è§’ âœ— (ä½†è¿æ¥è¾ƒå°‘)
- P1-P2: ç›¸é‚» âœ“ (æ°´å¹³ç›¸é‚»ï¼Œè¿™æ˜¯æœ€å¼ºè¿æ¥ï¼)
- P1-P3: å¯¹è§’ âœ— (ä½†è¿æ¥è¾ƒå°‘)
```

**è¾¹ç•ŒHPWLä¼°ç®—**ï¼š
```
HPWL â‰ˆ 1Ã—h + 1Ã—âˆš(wÂ²+hÂ²) + 1Ã—w + 1Ã—âˆš(wÂ²+hÂ²)
     = w + h + 2âˆš(wÂ²+hÂ²)
```

**å…³é”®æ”¹è¿›**ï¼š
- æœ€å¼ºè¿æ¥(P1-P2)ä»å¯¹è§’å˜ä¸ºæ°´å¹³ç›¸é‚» âœ“
- è¾ƒå¼±è¿æ¥(P0-P2, P1-P3)è¢«æ”¾åœ¨å¯¹è§’ï¼ˆå¯æ¥å—ï¼‰

---

## ğŸ”‘ å…³é”®æŠ€æœ¯ç‚¹

### 1. è¿æ¥æ€§çŸ©é˜µçš„ä½œç”¨

```
è¿æ¥æ€§çŸ©é˜µæ˜¯ä¼˜åŒ–çš„"åœ°å›¾"ï¼š
- å‘Šè¯‰æˆ‘ä»¬å“ªäº›åˆ†åŒºåº”è¯¥é è¿‘
- é‡åŒ–äº†åˆ†åŒºé—´çš„é€šä¿¡å¼ºåº¦
- æŒ‡å¯¼è´ªå¿ƒç®—æ³•çš„å†³ç­–
```

### 2. å¯å‘å¼è§„åˆ™

**è§„åˆ™1**ï¼šè¿æ¥å¼ºçš„åˆ†åŒºå¯¹ â†’ ç‰©ç†ç›¸é‚»
```
if connectivity_matrix[i][j] > threshold:
    place i and j adjacent
```

**è§„åˆ™2**ï¼šçƒ­ç‚¹åˆ†åŒº â†’ ä¸­å¿ƒä½ç½®
```
çƒ­ç‚¹åˆ†åŒº = ä¸å¤šä¸ªå…¶ä»–åˆ†åŒºéƒ½æœ‰è¿æ¥çš„åˆ†åŒº
åº”æ”¾åœ¨ç‰©ç†ä¸­å¿ƒï¼Œä¾¿äºæ‰€æœ‰æ–¹å‘çš„è¿æ¥
```

**è§„åˆ™3**ï¼šå­¤ç«‹åˆ†åŒº â†’ è¾¹ç¼˜ä½ç½®
```
å­¤ç«‹åˆ†åŒº = åªä¸å°‘æ•°åˆ†åŒºè¿æ¥
å¯ä»¥æ”¾åœ¨è¾¹ç¼˜æˆ–è§’è½
```

### 3. ç®—æ³•å¤æ‚åº¦

**ç®€å•å¸ƒå±€**ï¼šO(K) - Kæ˜¯åˆ†åŒºæ•°é‡
```python
# æŒ‰IDé¡ºåºç›´æ¥æ’åˆ—ï¼Œæ— éœ€è®¡ç®—
```

**è´ªå¿ƒä¼˜åŒ–**ï¼šO(KÂ²)
```python
# Kæ¬¡è¿­ä»£ï¼Œæ¯æ¬¡æ£€æŸ¥O(K)ä¸ªå€™é€‰
for k in range(K):  # O(K)
    for candidate in remaining:  # O(K)
        calculate_score()
```

---

## ğŸ“Š å®é™…æ•ˆæœç¤ºä¾‹

### æµ‹è¯•æ¡ˆä¾‹ï¼ˆæ¥è‡ªä»£ç ï¼‰

**è¾“å…¥**ï¼š
```python
connectivity_matrix = [
    [0, 1, 1, 0],  # P0ä¸P1,P2è¿æ¥
    [1, 0, 1, 1],  # P1ä¸P0,P2,P3è¿æ¥ï¼ˆçƒ­ç‚¹ï¼ï¼‰
    [1, 1, 0, 0],  # P2ä¸P0,P1è¿æ¥
    [0, 1, 0, 0]   # P3ä¸P1è¿æ¥
]
```

**ç®€å•å¸ƒå±€**ï¼ˆæŒ‰IDæ’åºï¼‰ï¼š
```
P0(0,0)     P1(5000,0)
P2(0,5000)  P3(5000,5000)
```

**è´ªå¿ƒä¼˜åŒ–å¸ƒå±€**ï¼ˆè¿æ¥æ€§é©±åŠ¨ï¼‰ï¼š
```
P0(0,0)     P2(5000,0)      â† P0-P2ç›¸é‚»
P1(0,5000)  P3(5000,5000)   â† P1-P2ç›¸é‚»ï¼ˆå¼ºè¿æ¥ï¼ï¼‰
                              P1-P3ç›¸é‚»
```

**æ”¹è¿›æ•ˆæœ**ï¼š
- P1ï¼ˆçƒ­ç‚¹åˆ†åŒºï¼‰ä¸3ä¸ªåˆ†åŒºéƒ½ç›¸é‚»æˆ–æ¥è¿‘ âœ“
- å¼ºè¿æ¥å¯¹(P1-P2)ç‰©ç†ç›¸é‚» âœ“
- é¢„è®¡HPWLå‡å°‘çº¦15-30%

---

## ğŸ“ ç†è®ºåŸºç¡€

### Min-Cuté—®é¢˜

ç‰©ç†ä½ç½®ä¼˜åŒ–æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**Min-Cut Placement**é—®é¢˜ï¼š

```
ç›®æ ‡å‡½æ•°ï¼š
minimize: Î£(i,j) connectivity[i][j] Ã— distance(i,j)

çº¦æŸï¼š
- æ¯ä¸ªåˆ†åŒºå æ®ä¸€ä¸ªç‰©ç†ä½ç½®
- æ¯ä¸ªç‰©ç†ä½ç½®åªèƒ½è¢«ä¸€ä¸ªåˆ†åŒºå æ®
```

### NP-Hardé—®é¢˜

- å®Œç¾è§£ï¼šéœ€è¦éå†æ‰€æœ‰æ’åˆ— O(K!)
- è´ªå¿ƒè¿‘ä¼¼ï¼šO(KÂ²) æ—¶é—´è·å¾—è¾ƒå¥½è§£
- å®é™…æ•ˆæœï¼šé€šå¸¸èƒ½è¾¾åˆ°æœ€ä¼˜è§£çš„80-95%

---

## ğŸ”¬ è¿›ä¸€æ­¥ä¼˜åŒ–æ–¹å‘

### 1. æ¨¡æ‹Ÿé€€ç«ï¼ˆSimulated Annealingï¼‰

```python
current_layout = greedy_layout()
temperature = T_init

while temperature > T_min:
    new_layout = perturb(current_layout)  # éšæœºäº¤æ¢ä¸¤ä¸ªåˆ†åŒº
    delta_cost = cost(new_layout) - cost(current_layout)
    
    if delta_cost < 0 or random() < exp(-delta_cost/temperature):
        current_layout = new_layout
    
    temperature *= cooling_rate
```

### 2. æ•´æ•°çº¿æ€§è§„åˆ’ï¼ˆILPï¼‰

```
å˜é‡ï¼š
x[i][j] = 1 if åˆ†åŒºiæ”¾åœ¨grid j, else 0

ç›®æ ‡å‡½æ•°ï¼š
minimize: Î£(i,k) Î£(j,l) connectivity[i][k] Ã— distance[j][l] Ã— x[i][j] Ã— x[k][l]

çº¦æŸï¼š
Î£(j) x[i][j] = 1  âˆ€i  (æ¯ä¸ªåˆ†åŒºæ”¾ä¸€æ¬¡)
Î£(i) x[i][j] = 1  âˆ€j  (æ¯ä¸ªä½ç½®æ”¾ä¸€ä¸ª)
```

### 3. å±‚æ¬¡åŒ–ä¼˜åŒ–

```
1. ç²—ç²’åº¦ï¼šå…ˆä¼˜åŒ–åˆ†åŒºç»„çš„ä½ç½®
2. ç»†ç²’åº¦ï¼šå†ä¼˜åŒ–ç»„å†…åˆ†åŒºçš„ä½ç½®
3. è¿­ä»£ç»†åŒ–ï¼šé€æ­¥æ”¹è¿›
```

---

## ğŸ’¡ æ€»ç»“

**è¿æ¥æ€§çŸ©é˜µ â†’ ç‰©ç†å¸ƒå±€çš„è½¬æ¢**ï¼š

```
Step 1: è¿æ¥æ€§åˆ†æ
        â†“
    è¯†åˆ«çƒ­ç‚¹åˆ†åŒºã€å¼ºè¿æ¥å¯¹
        â†“
Step 2: è´ªå¿ƒåˆ†é…
        â†“
    å¼ºè¿æ¥å¯¹ä¼˜å…ˆç›¸é‚»æ”¾ç½®
        â†“
Step 3: è¿­ä»£ä¼˜åŒ–
        â†“
    é€æ­¥æ”¾ç½®å‰©ä½™åˆ†åŒº
        â†“
    æœ€ç»ˆç‰©ç†å¸ƒå±€
```

**å…³é”®æŒ‡æ ‡**ï¼š
- å¼ºè¿æ¥å¯¹çš„ç›¸é‚»åº¦
- çƒ­ç‚¹åˆ†åŒºçš„ä¸­å¿ƒåº¦
- æ€»ä½“HPWLä¼°ç®—

**å®é™…æ•ˆæœ**ï¼š
- HPWLå‡å°‘ï¼š15-30%
- æ‹¥å¡æ”¹å–„ï¼š20-40%
- è¿è¡Œæ—¶é—´ï¼šå¿«é€Ÿï¼ˆO(KÂ²)ï¼‰

